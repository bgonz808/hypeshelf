echo "üöÄ Pre-push checks..."

# Type checking
echo "  Running type check..."
npm run typecheck || exit 1

# Full lint
echo "  Running lint..."
npm run lint || exit 1

# Tests
echo "  Running tests..."
npm run test || exit 1

# Secret scanning (strict on push)
if command -v gitleaks &> /dev/null; then
  echo "  Scanning for secrets..."
  gitleaks protect --staged --verbose || exit 1
fi

# Dependency audit
echo "  Auditing dependencies..."
npm audit --audit-level=high || echo "‚ö†Ô∏è  Audit warnings detected"

# i18n coverage check (ADR-004 Phase 2)
echo "  Checking i18n coverage..."
npm run i18n:check || exit 1

# Version check (conventional commits ‚Üí semver)
echo "  Checking version consistency..."
npx tsx scripts/check-version.ts || exit 1

echo "‚úÖ All pre-push checks passed"
